<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scan QR - Excalibur FRC</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/scout.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.1.3/html5-qrcode.min.js"></script>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><strong>Excalibur FRC 6738</strong></li>
            </ul>
            <ul>
                <li><a href="{{ url_for('home') }}">Home</a></li>
                <li><a href="{{ url_for('profile') }}">Profile</a></li>
                <li><a href="{{ url_for('contacts') }}">Contacts</a></li>
                <li><a href="{{ url_for('projects') }}">Projects</a></li>
                <li><a href="{{ url_for('logout') }}">Logout</a></li>
            </ul>
        </nav>
    </header>
    <main class="container">
        <h2>Scan QR Code</h2>
        <div id="qr-reader" style="width: 500px;"></div>
        <div id="qr-reader-results"></div>
        <form id="qr-form" method="POST" action="{{ url_for('scan_qr') }}">
            <input type="hidden" name="qual_number" id="qual_number">
            <input type="hidden" name="team" id="team">
            <input type="hidden" name="alliance" id="alliance">
            <input type="hidden" name="autonomous_amp" id="autonomous_amp">
            <input type="hidden" name="autonomous_speaker" id="autonomous_speaker">
            <input type="hidden" name="teleop_amp" id="teleop_amp">
            <input type="hidden" name="teleop_speaker" id="teleop_speaker">
            <input type="hidden" name="climb_choice" id="climb_choice">
            <input type="hidden" name="manual_climb_time" id="manual_climb_time">
            <input type="hidden" name="comments" id="comments">
            <button type="submit">Submit Scanned Data</button>
        </form>
    </main>
    <footer>
        <small><a href="#">Privacy Policy</a> â€¢ <a href="#">Terms of Service</a></small>
        <p>&copy; 2024 Excalibur FRC 6738</p>
    </footer>
    <script>
        function onScanSuccess(qrCodeMessage) {
            const data = JSON.parse(qrCodeMessage);
            document.getElementById('qual_number').value = data.qual_number;
            document.getElementById('team').value = data.team;
            document.getElementById('alliance').value = data.alliance;
            document.getElementById('autonomous_amp').value = data.autonomous_amp;
            document.getElementById('autonomous_speaker').value = data.autonomous_speaker;
            document.getElementById('teleop_amp').value = data.teleop_amp;
            document.getElementById('teleop_speaker').value = data.teleop_speaker;
            document.getElementById('climb_choice').value = data.climb_choice;
            document.getElementById('manual_climb_time').value = data.manual_climb_time;
            document.getElementById('comments').value = data.comments;
            document.getElementById('qr-form').submit();
        }

        var html5QrcodeScanner = new Html5QrcodeScanner(
            "qr-reader", { fps: 10, qrbox: 250 });
        html5QrcodeScanner.render(onScanSuccess);
    </script>
</body>
</html>
